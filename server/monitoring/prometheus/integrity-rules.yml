groups:
  - name: integrity.rules
    rules:
      - alert: IntegrityAuditFailures
        expr: increase(integrity_audit_failures_total[5m]) > 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Integrity audit failures detected"
          description: "One or more integrity audit runs reported failures in the last 5 minutes. Check the integrity audit logs and repair runs."

      - alert: IntegrityIssuesDetected
        expr: max_over_time(integrity_issues_found[5m]) > 0
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Integrity issues found"
          description: "The scheduled integrity audit reported one or more issues in the last 5 minutes. Details: check integrity checks or run manual audit via /api/population/integrity."